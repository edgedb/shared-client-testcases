[
  {
    "opts": {},
    "env": {},
    "fs": {
      "cwd": "/home/edgedb/test",
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/test/edgedb.toml": "",
        "/home/edgedb/.config/edgedb/projects/test-${HASH}": {
          "instance-name": "test_project",
          "project-path": "/home/edgedb/test"
        },
        "/home/edgedb/.config/edgedb/credentials/test_project.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {},
    "env": {},
    "fs": {
      "cwd": "/home/edgedb/test/sub/di/rect/or/ry",
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/test/edgedb.toml": "",
        "/home/edgedb/.config/edgedb/projects/test-${HASH}": {
          "instance-name": "test_project",
          "project-path": "/home/edgedb/test"
        },
        "/home/edgedb/.config/edgedb/credentials/test_project.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {},
    "env": {},
    "fs": {
      "cwd": "/home/edgedb/test",
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/test/edgedb.toml": "",
        "/home/edgedb/.config/edgedb/projects/test-${HASH}": {
          "instance-name": "test_project",
          "project-path": "/home/edgedb/test"
        }
      }
    },
    "error": {
      "type": "credentials_file_not_found"
    }
  },
  {
    "opts": {},
    "env": {},
    "fs": {
      "cwd": "/home/edgedb/test",
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/test/edgedb.toml": ""
      }
    },
    "error": {
      "type": "project_not_initialised"
    }
  },
  {
    "opts": {},
    "env": {},
    "error": {
      "type": "no_options_or_toml"
    }
  },
  {
    "opts": {},
    "env": {},
    "platform": "windows",
    "fs": {
      "cwd": "C:\\Users\\edgedb\\test",
      "homedir": "C:\\Users\\edgedb",
      "files": {
        "C:\\Users\\edgedb\\test\\edgedb.toml": "",
        "C:\\Users\\edgedb\\AppData\\Local\\EdgeDB\\config\\projects\\test-${HASH}": {
           "instance-name": "test_project",
           "project-path": "C:\\Users\\edgedb\\test"
        },
        "C:\\Users\\edgedb\\AppData\\Local\\EdgeDB\\config\\credentials\\test_project.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {},
    "env": {},
    "platform": "macos",
    "fs": {
      "cwd": "/Users/edgedb/test",
      "homedir": "/Users/edgedb",
      "files": {
        "/Users/edgedb/test/edgedb.toml": "",
        "/Users/edgedb/Library/Application Support/edgedb/projects/test-${HASH}": {
          "instance-name": "test_project",
          "project-path": "/Users/edgedb/test"
        },
        "/Users/edgedb/Library/Application Support/edgedb/credentials/test_project.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": 123, \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": \"10702\", \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "test3n",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"tls_cert_data\": \"-----BEGIN CERTIFICATE-----\\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\\nHn+GmxZA\\n-----END CERTIFICATE-----\\n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "test3n",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"tls_verify_hostname\": true, \"tls_cert_data\": \"-----BEGIN CERTIFICATE-----\\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\\nHn+GmxZA\\n-----END CERTIFICATE-----\\n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "test3n",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"tls_security\": \"strict\", \"tls_cert_data\": \"-----BEGIN CERTIFICATE-----\\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\\nHn+GmxZA\\n-----END CERTIFICATE-----\\n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "test3n",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"tls_verify_hostname\": \"true\", \"tls_cert_data\": \"-----BEGIN CERTIFICATE-----\\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\\nHn+GmxZA\\n-----END CERTIFICATE-----\\n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {},
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"tls_security\": true, \"tls_cert_data\": \"-----BEGIN CERTIFICATE-----\\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\\nHn+GmxZA\\n-----END CERTIFICATE-----\\n\"}"
      }
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "dsn": "test_123"
    },
    "env": {},
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_123.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test-123"
    },
    "env": {},
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test-123.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "123-test"
    },
    "env": {},
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/123-test.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "test-ðŸ¦•"
    },
    "env": {},
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test-ðŸ¦•.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "user3",
      "password": "123123",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb:/user3:123123@localhost:5555/abcdef"
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "user3:123123@localhost:5555/abcdef"
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost:fivesixfivesix"
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "egdedb://user3:123123@localhost:5555/abcdef"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedbadmin://user3:123123@localhost:5555/abcdef"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "host": "/tmp/test"
    },
    "error": {
      "type": "unix_socket_unsupported"
    }
  },
  {
    "opts": {
      "port": 1234
    },
    "result": {
      "address": ["localhost", 1234],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": "1234"
    },
    "result": {
      "address": ["localhost", 1234],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 1
    },
    "result": {
      "address": ["localhost", 1],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 0
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": 65535
    },
    "result": {
      "address": ["localhost", 65535],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 65536
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": 123.456
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": "123.456"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": "string"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": "tcp://localhost:123"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "env": {
      "EDGEDB_PORT": "1234"
    },
    "result": {
      "address": ["localhost", 1234],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_PORT": "tcp://localhost:123"
    },
    "error": {
      "type": "no_options_or_toml"
    },
    "warnings": ["docker_tcp_port"]
  },
  {
    "env": {
      "EDGEDB_PORT": "invalid"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": 1234
    },
    "env": {
      "EDGEDB_PORT": "invalid"
    },
    "result": {
      "address": ["localhost", 1234],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_PORT": "1234"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_PORT": "tcp://localhost:123"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "user3",
      "password": "123123",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    },
    "warnings": ["docker_tcp_port"]
  },
  {
    "opts": {
      "host": "test.local",
      "port": 12345
    },
    "result": {
      "address": ["test.local", 12345],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef",
      "host": "test.local"
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef",
      "port": 10701
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "dsn": "test_instance",
      "port": 10701
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef",
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "host": "test.local",
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "port": 1234,
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef",
      "host": "localhost",
      "port": 10701,
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_opts"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "test.local",
      "EDGEDB_PORT": "12345"
    },
    "result": {
      "address": ["test.local", 12345],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_HOST": "test.local"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_PORT": "10701"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "test.local",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_PORT": "1234",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_PORT": "1234",
      "EDGEDB_INSTANCE": "test_instance"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "test.local",
      "EDGEDB_INSTANCE": "test_instance"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_INSTANCE": "test_instance"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json",
      "EDGEDB_INSTANCE": "test_instance"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_HOST": "localhost",
      "EDGEDB_PORT": "10701",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json",
      "EDGEDB_INSTANCE": "test_instance"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef"
    },
    "env": {
      "EDGEDB_HOST": "test.local"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "user3",
      "password": "123123",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 10701
    },
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef"
    },
    "result": {
      "address": ["localhost", 10701],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 10701
    },
    "env": {
      "EDGEDB_DSN": "test_instance"
    },
    "result": {
      "address": ["localhost", 10701],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "env": {
      "EDGEDB_PORT": "10701"
    },
    "fs": {
      "homedir": "/home/edgedb"
    },
    "error": {
      "type": "credentials_file_not_found"
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "env": {
      "EDGEDB_PORT": "10701"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef"
    },
    "env": {
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "user3",
      "password": "123123",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "host": "test.local"
    },
    "env": {
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "result": {
      "address": ["test.local", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "credentialsFile": "/home/edgedb/test/credentials.json"
    },
    "env": {
      "EDGEDB_PORT": "1234"
    },
    "fs": {
      "files": {
        "/home/edgedb/test/credentials.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "test3n",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "host": "localhost",
      "port": 10701
    },
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "result": {
      "address": ["localhost", 10701],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "database": "testdb"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://user3:123123@localhost:5555/abcdef",
      "EDGEDB_CREDENTIALS_FILE": "/home/edgedb/test/credentials.json"
    },
    "error": {
      "type": "multiple_compound_env"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "host1:1111,host2:2222"
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "host1,host2"
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "opts": {
      "host": "host1,host2"
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "env": {
      "EDGEDB_PORT": "1111,2222"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "port": "1111,2222"
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user@host1:1111,host2:2222/db"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user@host1,host2/db"
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "opts": {
      "dsn": "edgedb:///dbname?host=/unix_sock/test&user=spam"
    },
    "error": {
      "type": "unix_socket_unsupported"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef?param=123"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "user3",
      "password": "123123",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@localhost:5555/abcdef?param=sss&param=123"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost:5555/abcdef?param=123&user=testuser"
    },
    "result": {
      "address": ["localhost", 5555],
      "database": "abcdef",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost:5555/abcdef?param=123&user=testuser&port=2222&database=testdb"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost/abcdef?param=123&user=testuser&port=2222"
    },
    "result": {
      "address": ["localhost", 2222],
      "database": "abcdef",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost/?param=123&user=testuser&port=2222&database=testdb"
    },
    "result": {
      "address": ["localhost", 2222],
      "database": "testdb",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost?param=123&user=testuser&port=2222&database=testdb"
    },
    "result": {
      "address": ["localhost", 2222],
      "database": "testdb",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost?param=123&host=testhost&user=testuser&port=2222&database=testdb"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?param=123&host=testhost&user=testuser&port=2222&database=testdb"
    },
    "result": {
      "address": ["testhost", 2222],
      "database": "testdb",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?param=123&host=testhost&user=testuser&port=2222&database=testdb&host=localhost"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?param=123&user=testuser&port=2222&database=testdb&host=test.local"
    },
    "result": {
      "address": ["test.local", 2222],
      "database": "testdb",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "param": "123"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost/database/with/slash?user=testuser&port=2222"
    },
    "result": {
      "address": ["localhost", 2222],
      "database": "database/with/slash",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://localhost/?user=testuser&port=2222&database=/database/with/slash"
    },
    "result": {
      "address": ["localhost", 2222],
      "database": "database/with/slash",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password=not_secret_password"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": "not_secret_password",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_env=SECRET_PASSWORD"
    },
    "env": {
      "SECRET_PASSWORD": "super_secret_password"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": "super_secret_password",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_env=EDGEDB_PASSWORD"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": "password",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser:pass@localhost/db?password_env=EDGEDB_PASSWORD"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "error": {
      "type": "invalid_dsn"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_env=EDGEDB_PASSWORD"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": "password",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_env=EDGEDB_PASSWORD"
    },
    "error": {
      "type": "env_not_found"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_file=/home/edgedb/password"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "fs": {
      "files": {
        "/home/edgedb/password": "12345"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "db",
      "user": "testuser",
      "password": "12345",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testuser@localhost/db?password_file=/home/edgedb/password"
    },
    "env": {
      "EDGEDB_PASSWORD": "password"
    },
    "error": {
      "type": "file_not_found"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?a=abc&b=def",
      "serverSettings": {
        "c": "ghi"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "a": "abc",
        "b": "def",
        "c": "ghi"
      }
    }
  },
  {
    "opts": {
      "serverSettings": {
        "c": "ghi"
      }
    },
    "env": {
      "EDGEDB_DSN": "edgedb://?a=abc&b=def"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "a": "abc",
        "b": "def",
        "c": "ghi"
      }
    }
  },
  {
    "opts": {
      "serverSettings": {
        "a": "jkl",
        "c": "ghi"
      }
    },
    "env": {
      "EDGEDB_DSN": "edgedb://?a=abc&b=def"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "a": "jkl",
        "b": "def",
        "c": "ghi"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?a=abc&b=def",
      "serverSettings": {
        "a": "jkl",
        "c": "ghi"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {
        "a": "jkl",
        "b": "def",
        "c": "ghi"
      }
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "tlsSecurity": "no_host_verification"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "tlsSecurity": "insecure"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://?tls_security=strict",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://?tls_security=strict",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "tlsCAFile": "/home/edgedb/test/cert.pem",
      "tlsSecurity": "strict"
    },
    "fs": {
      "files": {
        "/home/edgedb/test/cert.pem": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "tlsCAFile": "/home/edgedb/test/cert.pem"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "strict"
    },
    "fs": {
      "files": {
        "/home/edgedb/test/cert.pem": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "tlsCAFile": "/home/edgedb/test/cert.pem"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "default",
      "EDGEDB_CLIENT_SECURITY": "default"
    },
    "fs": {
      "files": {
        "/home/edgedb/test/cert.pem": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n"
      }
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": "-----BEGIN CERTIFICATE-----\nMIICEjCCAXsCAg36MA0GCSqGSIb3DQEBBQUAMIGbMQswCQYDVQQGEwJKUDEOMAwG\nA1UECBMFVG9reW8xEDAOBgNVBAcTB0NodW8ta3UxETAPBgNVBAoTCEZyYW5rNERE\nMRgwFgYDVQQLEw9XZWJDZXJ0IFN1cHBvcnQxGDAWBgNVBAMTD0ZyYW5rNEREIFdl\nYiBDQTEjMCEGCSqGSIb3DQEJARYUc3VwcG9ydEBmcmFuazRkZC5jb20wHhcNMTIw\nODIyMDUyNjU0WhcNMTcwODIxMDUyNjU0WjBKMQswCQYDVQQGEwJKUDEOMAwGA1UE\nCAwFVG9reW8xETAPBgNVBAoMCEZyYW5rNEREMRgwFgYDVQQDDA93d3cuZXhhbXBs\nZS5jb20wXDANBgkqhkiG9w0BAQEFAANLADBIAkEAm/xmkHmEQrurE/0re/jeFRLl\n8ZPjBop7uLHhnia7lQG/5zDtZIUC3RVpqDSwBuw/NTweGyuP+o8AG98HxqxTBwID\nAQABMA0GCSqGSIb3DQEBBQUAA4GBABS2TLuBeTPmcaTaUW/LCB2NYOy8GMdzR1mx\n8iBIu2H6/E2tiY3RIevV2OW61qY2/XRQg7YPxx3ffeUugX9F4J/iPnnu1zAxxyBy\n2VguKv4SWjRFoRkIfIlHX0qVviMhSlNy2ioFLy7JcPZb+v3ftDGywUqcBiVDoea0\nHn+GmxZA\n-----END CERTIFICATE-----\n",
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "default",
      "EDGEDB_CLIENT_SECURITY": "default"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure",
      "EDGEDB_CLIENT_SECURITY": "default"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification",
      "EDGEDB_CLIENT_SECURITY": "default"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "strict",
      "EDGEDB_CLIENT_SECURITY": "default"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "default",
      "EDGEDB_CLIENT_SECURITY": "insecure_dev_mode"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure",
      "EDGEDB_CLIENT_SECURITY": "insecure_dev_mode"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification",
      "EDGEDB_CLIENT_SECURITY": "insecure_dev_mode"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "strict",
      "EDGEDB_CLIENT_SECURITY": "insecure_dev_mode"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "default",
      "EDGEDB_CLIENT_SECURITY": "strict"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure",
      "EDGEDB_CLIENT_SECURITY": "strict"
    },
    "error": {
      "type": "invalid_tls_security"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification",
      "EDGEDB_CLIENT_SECURITY": "strict"
    },
    "error": {
      "type": "invalid_tls_security"
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "strict",
      "EDGEDB_CLIENT_SECURITY": "strict"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "env": {
      "EDGEDB_DSN": "edgedb://",
      "EDGEDB_CLIENT_TLS_SECURITY": "invalid value"
    },
    "error": {
      "type": "invalid_tls_security"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://"
    },
    "env": {
      "EDGEDB_CLIENT_TLS_SECURITY": "invalid value"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "host": ""
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?host="
    },
    "error": {
      "type": "invalid_host"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?host_env="
    },
    "error": {
      "type": "env_not_found"
    }
  },
  {
    "opts": {
      "port": ""
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?port="
    },
    "error": {
      "type": "invalid_port"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?host_env="
    },
    "error": {
      "type": "env_not_found"
    }
  },
  {
    "opts": {
      "dsn": ""
    },
    "error": {
      "type": "invalid_dsn_or_instance_name"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "user": ""
    },
    "error": {
      "type": "invalid_user"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?user="
    },
    "error": {
      "type": "invalid_user"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "password": ""
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": "",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?password="
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": "",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "database": ""
    },
    "error": {
      "type": "invalid_database"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?database"
    },
    "error": {
      "type": "invalid_database"
    }
  },
  {
    "opts": {
      "credentialsFile": ""
    },
    "error": {
      "type": "invalid_credentials_file"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "tlsCAFile": ""
    },
    "error": {
      "type": "file_not_found"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?tls_cert_file="
    },
    "error": {
      "type": "file_not_found"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://",
      "tlsSecurity": ""
    },
    "error": {
      "type": "invalid_tls_security"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?tls_security"
    },
    "error": {
      "type": "invalid_tls_security"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://?password_env=DOESNT_EXIST",
      "password": "secret"
    },
    "result": {
      "address": ["localhost", 5656],
      "database": "edgedb",
      "user": "edgedb",
      "password": "secret",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "port": 65535
    },
    "env": {
      "EDGEDB_DSN": "edgedb://testhost:1234/?database=db"
    },
    "result": {
      "address": ["localhost", 65535],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {},
    "env": {
      "EDGEDB_DSN": "edgedb://testhost:1234/?database=db",
      "EDGEDB_DATABASE": "test_db"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "test_db",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "user": "user_123"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://testhost:1234/?database=db",
      "EDGEDB_DATABASE": "test_db"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "test_db",
      "user": "user_123",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "user": "user_123",
      "database": "new_db"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://testhost:1234/?database=db",
      "EDGEDB_DATABASE": "test_db"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "new_db",
      "user": "user_123",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "user": "user_123",
      "database": "new_db"
    },
    "env": {
      "EDGEDB_DSN": "edgedb://testhost:1234/?database=",
      "EDGEDB_DATABASE": "test_db"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "new_db",
      "user": "user_123",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testhost:1234/?database=db",
      "user": "user_123"
    },
    "env": {
      "EDGEDB_DATABASE": "test_db"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "db",
      "user": "user_123",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "edgedb://testhost:1234/?database=db",
      "user": "user_123"
    },
    "env": {
      "EDGEDB_PASSWORD": "qwerty"
    },
    "result": {
      "address": ["testhost", 1234],
      "database": "db",
      "user": "user_123",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "user": "super_user"
    },
    "env": {
      "EDGEDB_INSTANCE": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "super_user",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "user": "super_user"
    },
    "env": {
      "EDGEDB_INSTANCE": "test_instance",
      "EDGEDB_CLIENT_TLS_SECURITY": "no_host_verification"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "super_user",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
	{
    "opts": {
      "user": "super_user"
    },
    "env": {
      "EDGEDB_INSTANCE": "test_instance",
      "EDGEDB_CLIENT_TLS_SECURITY": "insecure"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"test3n\", \"password\": \"lZTBy1RVCfOpBAOwSCwIyBIR\", \"database\": \"test3n\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "test3n",
      "user": "super_user",
      "password": "lZTBy1RVCfOpBAOwSCwIyBIR",
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"edgedb\", \"tls_verify_hostname\": true, \"tls_security\": \"strict\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"edgedb\", \"tls_verify_hostname\": false, \"tls_security\": \"no_host_verification\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "no_host_verification",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"edgedb\", \"tls_verify_hostname\": false, \"tls_security\": \"insecure\"}"
      }
    },
    "result": {
      "address": ["localhost", 10702],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "insecure",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"edgedb\", \"tls_verify_hostname\": true, \"tls_security\": \"insecure\"}"
      }
    },
    "error": {
      "type":"invalid_credentials_file"
    }
  },
  {
    "opts": {
      "dsn": "test_instance"
    },
    "fs": {
      "homedir": "/home/edgedb",
      "files": {
        "/home/edgedb/.config/edgedb/credentials/test_instance.json": "{\"port\": 10702, \"user\": \"edgedb\", \"tls_verify_hostname\": true, \"tls_security\": \"no_host_verification\"}"
      }
    },
    "error": {
      "type":"invalid_credentials_file"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3:123123@[::1]:5555/abcdef"
    },
    "result": {
      "address": ["::1", 5555],
      "database": "abcdef",
      "password": "123123",
      "serverSettings": {},
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "user": "user3"
    }
  },
  {
    "opts": {
      "dsn": "edgedb://user3@[fe80::1ff:fe23:4567:890a%25eth0]:3000/ab"
    },
    "result": {
      "address": ["fe80::1ff:fe23:4567:890a%eth0", 3000],
      "database": "ab",
      "password": null,
      "serverSettings": {},
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "user": "user3"
    }
  },
  {
    "env": {
      "EDGEDB_HOST": "fe80::1ff:fe23:4567:890a%eth0",
      "EDGEDB_PORT": "12341"
    },
    "result": {
      "address": ["fe80::1ff:fe23:4567:890a%eth0", 12341],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  },
  {
    "opts": {
      "host": "fe80::1ff:fe23:4567:890a%eth0",
      "port": 12342
    },
    "result": {
      "address": ["fe80::1ff:fe23:4567:890a%eth0", 12342],
      "database": "edgedb",
      "user": "edgedb",
      "password": null,
      "tlsCAData": null,
      "tlsSecurity": "strict",
      "serverSettings": {}
    }
  }
]
